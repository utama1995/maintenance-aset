<!DOCTYPE html>
<html>
<head>
<title>Portal Maintenance Aset</title>

<style>

body {
font-family: Arial;
background-color: #f4f6f8;
text-align: center;
padding-top: 50px;
}

.container {
background-color: white;
width: 420px;
margin: auto;
padding: 25px;
border-radius: 10px;
box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
}

.menu button {
margin: 5px;
padding: 10px 15px;
cursor: pointer;
background-color:#1976d2;
color:white;
border:none;
}

.menu button:hover {
background-color:#0d47a1;
}

input, textarea {
width: 90%;
padding: 10px;
margin-top: 10px;
}

.hidden {
display:none;
}

#hasil, #hasilLapor {
margin-top: 15px;
text-align:left;
}

.success {
color:green;
font-weight:bold;
}

.error {
color:red;
font-weight:bold;
}

</style>

</head>

<body>

<div class="container">

<h2>PORTAL MAINTENANCE ASET</h2>

<div class="menu">

<button onclick="showCek()">CEK STATUS</button>
<button onclick="showLapor()">LAPOR KERUSAKAN</button>

</div>

<!-- CEK STATUS -->

<div id="cekSection">

<input type="text" id="ticket" placeholder="Masukkan Ticket ID">

<br><br>

<button onclick="cekStatus()">CEK</button>

<div id="hasil"></div>

</div>

<!-- LAPOR -->

<div id="laporSection" class="hidden">

<input type="text" id="nama" placeholder="Nama Pelapor">

<input type="text" id="cabang" placeholder="Cabang">

<input type="text" id="aset" placeholder="Nama Aset">

<textarea id="deskripsi" placeholder="Deskripsi Kerusakan"></textarea>

<input type="file" id="foto">

<br><br>

<button onclick="kirimLaporan()">KIRIM LAPORAN</button>

<div id="hasilLapor"></div>

</div>

</div>

<script>

var API_URL = "https://script.google.com/macros/s/AKfycbzDOgEKOU9odEntVc06n97dGk9hEtLul_qBMZiFD6r5Lk7yN7fLgTUe5ygQjDKUMVSiQA/exec";

function showCek(){

document.getElementById("cekSection").classList.remove("hidden");
document.getElementById("laporSection").classList.add("hidden");

}

function showLapor(){

document.getElementById("laporSection").classList.remove("hidden");
document.getElementById("cekSection").classList.add("hidden");

}

function cekStatus(){

var ticket=document.getElementById("ticket").value;

if(ticket==""){
document.getElementById("hasil").innerHTML="<span class='error'>Masukkan Ticket ID</span>";
return;
}

document.getElementById("hasil").innerHTML="Loading...";

fetch(API_URL+"?ticket="+ticket)
.then(res=>res.json())
.then(data=>{

if(data.error){

document.getElementById("hasil").innerHTML="<span class='error'>Ticket tidak ditemukan</span>";

}else{

document.getElementById("hasil").innerHTML=

"<b>Ticket:</b> "+data.ticket+"<br><br>"+
"<b>Nama:</b> "+data.nama+"<br><br>"+
"<b>Cabang:</b> "+data.cabang+"<br><br>"+
"<b>Aset:</b> "+data.aset+"<br><br>"+
"<b>Status:</b> "+data.status+"<br><br>"+
"<b>Vendor:</b> "+data.vendor+"<br><br>"+
"<b>Catatan:</b> "+data.catatan;

}

});

}

function kirimLaporan(){

var nama=document.getElementById("nama").value;
var cabang=document.getElementById("cabang").value;
var aset=document.getElementById("aset").value;
var deskripsi=document.getElementById("deskripsi").value;

var file=document.getElementById("foto").files[0];

if(!nama||!cabang||!aset||!deskripsi||!file){

document.getElementById("hasilLapor").innerHTML="<span class='error'>Lengkapi semua data</span>";
return;

}

document.getElementById("hasilLapor").innerHTML="Mengirim laporan...";

var reader=new FileReader();

reader.onload=function(){

var base64=reader.result.split(',')[1];

fetch(API_URL,{

method:"POST",

body:new URLSearchParams({

nama:nama,
cabang:cabang,
aset:aset,
deskripsi:deskripsi,
foto:base64

})

})
.then(res=>res.json())
.then(data=>{

if(data.success){

document.getElementById("hasilLapor").innerHTML=
"<span class='success'>Laporan berhasil<br>Ticket ID: "+data.ticket+"</span>";

}else{

document.getElementById("hasilLapor").innerHTML=
"<span class='error'>Gagal kirim laporan</span>";

}

})
.catch(err=>{

document.getElementById("hasilLapor").innerHTML=
"<span class='error'>Error koneksi server</span>";

});

};

reader.readAsDataURL(file);

}

</script>

</body>
</html>




